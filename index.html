<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Echoes of the Obelisk</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loading-screen">
        <div class="loading-content">
            <h1>ECHOES OF THE OBELISK</h1>
            <div class="loading-bar">
                <div class="loading-progress" id="loading-progress"></div>
            </div>
            <p id="loading-text">Initializing...</p>
        </div>
    </div>

    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        
        <!-- HUD -->
        <div id="hud">
            <div id="health-bar">
                <div id="health-fill"></div>
                <span id="health-text">100/100</span>
            </div>
            <div id="xp-display">
                <span id="xp-icon">◆</span>
                <span id="xp-value">0</span>
            </div>
            <div id="floor-display">FLOOR <span id="floor-number">1</span></div>
        </div>

        <!-- Ability cooldowns -->
        <div id="ability-bar">
            <div class="ability-slot" id="ability-spread" data-ability="spread">
                <div class="ability-icon">⁂</div>
                <div class="ability-cooldown"></div>
                <span class="ability-key">1</span>
            </div>
            <div class="ability-slot" id="ability-burst" data-ability="burst">
                <div class="ability-icon">⚡</div>
                <div class="ability-cooldown"></div>
                <span class="ability-key">2</span>
            </div>
            <div class="ability-slot" id="ability-mega" data-ability="mega">
                <div class="ability-icon">●</div>
                <div class="ability-cooldown"></div>
                <span class="ability-key">3</span>
            </div>
        </div>

        <!-- Mobile controls -->
        <div id="mobile-controls">
            <div id="joystick-zone">
                <div id="joystick-base">
                    <div id="joystick-stick"></div>
                </div>
            </div>
            <div id="action-buttons">
                <button id="btn-jump" class="action-btn">JUMP</button>
                <button id="btn-attack" class="action-btn primary">ATTACK</button>
            </div>
            <div id="ability-buttons">
                <button id="btn-spread" class="ability-btn">⁂</button>
                <button id="btn-burst" class="ability-btn">⚡</button>
                <button id="btn-mega" class="ability-btn">●</button>
            </div>
        </div>

        <!-- Dialogue box -->
        <div id="dialogue-box" class="hidden">
            <div id="dialogue-speaker"></div>
            <div id="dialogue-text"></div>
            <div id="dialogue-continue">TAP TO CONTINUE</div>
        </div>

        <!-- Lore fragment display -->
        <div id="lore-display" class="hidden">
            <div id="lore-content"></div>
            <button id="lore-close">CLOSE</button>
        </div>

        <!-- Pause menu -->
        <div id="pause-menu" class="hidden">
            <h2>PAUSED</h2>
            <button id="btn-resume">RESUME</button>
            <button id="btn-town">RETURN TO CAMP</button>
            <button id="btn-controls">CONTROLS</button>
        </div>

        <!-- Death screen -->
        <div id="death-screen" class="hidden">
            <h2>FALLEN</h2>
            <p>The obelisk claims another soul...</p>
            <p id="xp-lost">XP Lost: <span>0</span></p>
            <button id="btn-retry">TRY AGAIN</button>
            <button id="btn-retreat">RETREAT TO CAMP</button>
        </div>

        <!-- Victory screen -->
        <div id="victory-screen" class="hidden">
            <h2>FLOOR CLEARED</h2>
            <p id="xp-gained">XP Gained: <span>0</span></p>
            <button id="btn-next-floor">DESCEND DEEPER</button>
            <button id="btn-return-camp">RETURN TO CAMP</button>
        </div>

        <!-- Final victory screen -->
        <div id="final-victory" class="hidden">
            <h2>THE OBELISK AWAKENS</h2>
            <div id="final-text"></div>
            <button id="btn-credits">CONTINUE</button>
        </div>

        <!-- Town UI -->
        <div id="town-ui" class="hidden">
            <div id="town-header">
                <h2>EXPEDITION CAMP</h2>
                <div id="town-xp">◆ <span id="town-xp-value">0</span></div>
            </div>
            <button id="btn-enter-dungeon">ENTER THE OBELISK</button>
            <div id="floor-select" class="hidden">
                <h3>SELECT FLOOR</h3>
                <div id="floor-buttons"></div>
                <button id="btn-cancel-floor">CANCEL</button>
            </div>
        </div>

        <!-- Shop UI -->
        <div id="shop-ui" class="hidden">
            <h3 id="shop-title">SHOP</h3>
            <div id="shop-items"></div>
            <button id="btn-close-shop">CLOSE</button>
        </div>

        <!-- Pause button -->
        <button id="btn-pause">❚❚</button>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <script type="module" src="game.js"></script>
</body>
</html>
